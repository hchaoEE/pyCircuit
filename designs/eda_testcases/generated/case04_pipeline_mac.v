`include "pyc_reg.v"
`include "pyc_fifo.v"

`include "pyc_byte_mem.v"

`include "pyc_sync_mem.v"
`include "pyc_sync_mem_dp.v"
`include "pyc_async_fifo.v"
`include "pyc_cdc_sync.v"

// Generated by pycc (pyCircuit)
// Module: pipeline_mac

module pipeline_mac (
  input clk,
  input rst,
  input [15:0] a_in,
  input [15:0] b_in,
  input valid_in,
  input acc_clear,
  input saturate_mode,
  output [31:0] result,
  output valid_out,
  output [39:0] accumulator
);

wire [31:0] a_ext__case04_pipeline_mac__L44; // pyc.name="a_ext__case04_pipeline_mac__L44"
wire [15:0] a_in__case04_pipeline_mac__L15; // pyc.name="a_in__case04_pipeline_mac__L15"
wire [39:0] acc__case04_pipeline_mac__L36; // pyc.name="acc__case04_pipeline_mac__L36"
wire [39:0] acc_base__case04_pipeline_mac__L54; // pyc.name="acc_base__case04_pipeline_mac__L54"
wire acc_clear__case04_pipeline_mac__L18; // pyc.name="acc_clear__case04_pipeline_mac__L18"
wire [39:0] acc_q; // pyc.name="acc_q"
wire [39:0] acc_q__next; // pyc.name="acc_q__next"
wire [39:0] acc_val__case04_pipeline_mac__L53; // pyc.name="acc_val__case04_pipeline_mac__L53"
wire [31:0] b_ext__case04_pipeline_mac__L45; // pyc.name="b_ext__case04_pipeline_mac__L45"
wire [15:0] b_in__case04_pipeline_mac__L16; // pyc.name="b_in__case04_pipeline_mac__L16"
wire overflow__case04_pipeline_mac__L59; // pyc.name="overflow__case04_pipeline_mac__L59"
wire [39:0] prod_ext__case04_pipeline_mac__L55; // pyc.name="prod_ext__case04_pipeline_mac__L55"
wire [31:0] product__case04_pipeline_mac__L46; // pyc.name="product__case04_pipeline_mac__L46"
wire [39:0] pyc_add_48; // op=pyc.add
wire pyc_and_50; // op=pyc.and
wire [31:0] pyc_comb_10; // op=pyc.comb
wire [39:0] pyc_comb_11; // op=pyc.comb
wire [39:0] pyc_comb_12; // op=pyc.comb
wire [15:0] pyc_comb_13; // op=pyc.comb
wire [15:0] pyc_comb_14; // op=pyc.comb
wire pyc_comb_15; // op=pyc.comb
wire pyc_comb_16; // op=pyc.comb
wire pyc_comb_17; // op=pyc.comb
wire [15:0] pyc_comb_19; // op=pyc.comb
wire [15:0] pyc_comb_21; // op=pyc.comb
wire pyc_comb_23; // op=pyc.comb
wire pyc_comb_25; // op=pyc.comb
wire pyc_comb_27; // op=pyc.comb
wire [31:0] pyc_comb_29; // op=pyc.comb
wire pyc_comb_31; // op=pyc.comb
wire pyc_comb_33; // op=pyc.comb
wire pyc_comb_35; // op=pyc.comb
wire [39:0] pyc_comb_37; // op=pyc.comb
wire pyc_comb_39; // op=pyc.comb
wire [39:0] pyc_comb_44; // op=pyc.comb
wire [31:0] pyc_comb_45; // op=pyc.comb
wire [39:0] pyc_comb_52; // op=pyc.comb
wire [31:0] pyc_comb_55; // op=pyc.comb
wire pyc_comb_7; // op=pyc.comb
wire [15:0] pyc_comb_8; // op=pyc.comb
wire pyc_comb_9; // op=pyc.comb
wire pyc_constant_1; // op=pyc.constant
wire [15:0] pyc_constant_2; // op=pyc.constant
wire pyc_constant_3; // op=pyc.constant
wire [31:0] pyc_constant_4; // op=pyc.constant
wire [39:0] pyc_constant_5; // op=pyc.constant
wire [39:0] pyc_constant_6; // op=pyc.constant
wire pyc_extract_49; // op=pyc.extract
wire [31:0] pyc_extract_54; // op=pyc.extract
wire [31:0] pyc_mul_43; // op=pyc.mul
wire [39:0] pyc_mux_46; // op=pyc.mux
wire [39:0] pyc_mux_51; // op=pyc.mux
wire [39:0] pyc_mux_53; // op=pyc.mux
wire [15:0] pyc_reg_18; // op=pyc.reg
wire [15:0] pyc_reg_20; // op=pyc.reg
wire pyc_reg_22; // op=pyc.reg
wire pyc_reg_24; // op=pyc.reg
wire pyc_reg_26; // op=pyc.reg
wire [31:0] pyc_reg_28; // op=pyc.reg
wire pyc_reg_30; // op=pyc.reg
wire pyc_reg_32; // op=pyc.reg
wire pyc_reg_34; // op=pyc.reg
wire [39:0] pyc_reg_36; // op=pyc.reg
wire pyc_reg_38; // op=pyc.reg
wire [39:0] pyc_reg_40; // op=pyc.reg
wire [31:0] pyc_zext_41; // op=pyc.zext
wire [31:0] pyc_zext_42; // op=pyc.zext
wire [39:0] pyc_zext_47; // op=pyc.zext
wire [39:0] raw_sum__case04_pipeline_mac__L56; // pyc.name="raw_sum__case04_pipeline_mac__L56"
wire [31:0] result__case04_pipeline_mac__L68; // pyc.name="result__case04_pipeline_mac__L68"
wire [15:0] s1_a; // pyc.name="s1_a"
wire [15:0] s1_a__case04_pipeline_mac__L21; // pyc.name="s1_a__case04_pipeline_mac__L21"
wire [15:0] s1_a__next; // pyc.name="s1_a__next"
wire [15:0] s1_b; // pyc.name="s1_b"
wire [15:0] s1_b__case04_pipeline_mac__L22; // pyc.name="s1_b__case04_pipeline_mac__L22"
wire [15:0] s1_b__next; // pyc.name="s1_b__next"
wire s1_clr; // pyc.name="s1_clr"
wire s1_clr__case04_pipeline_mac__L24; // pyc.name="s1_clr__case04_pipeline_mac__L24"
wire s1_clr__next; // pyc.name="s1_clr__next"
wire s1_sat; // pyc.name="s1_sat"
wire s1_sat__case04_pipeline_mac__L25; // pyc.name="s1_sat__case04_pipeline_mac__L25"
wire s1_sat__next; // pyc.name="s1_sat__next"
wire s1_v; // pyc.name="s1_v"
wire s1_v__case04_pipeline_mac__L23; // pyc.name="s1_v__case04_pipeline_mac__L23"
wire s1_v__next; // pyc.name="s1_v__next"
wire s2_clr; // pyc.name="s2_clr"
wire s2_clr__case04_pipeline_mac__L29; // pyc.name="s2_clr__case04_pipeline_mac__L29"
wire s2_clr__next; // pyc.name="s2_clr__next"
wire [31:0] s2_prod; // pyc.name="s2_prod"
wire [31:0] s2_prod__case04_pipeline_mac__L27; // pyc.name="s2_prod__case04_pipeline_mac__L27"
wire [31:0] s2_prod__next; // pyc.name="s2_prod__next"
wire s2_sat; // pyc.name="s2_sat"
wire s2_sat__case04_pipeline_mac__L30; // pyc.name="s2_sat__case04_pipeline_mac__L30"
wire s2_sat__next; // pyc.name="s2_sat__next"
wire s2_v; // pyc.name="s2_v"
wire s2_v__case04_pipeline_mac__L28; // pyc.name="s2_v__case04_pipeline_mac__L28"
wire s2_v__next; // pyc.name="s2_v__next"
wire [39:0] s3_sum; // pyc.name="s3_sum"
wire [39:0] s3_sum__case04_pipeline_mac__L32; // pyc.name="s3_sum__case04_pipeline_mac__L32"
wire [39:0] s3_sum__next; // pyc.name="s3_sum__next"
wire s3_v; // pyc.name="s3_v"
wire s3_v__case04_pipeline_mac__L33; // pyc.name="s3_v__case04_pipeline_mac__L33"
wire s3_v__next; // pyc.name="s3_v__next"
wire [39:0] sat_sum__case04_pipeline_mac__L60; // pyc.name="sat_sum__case04_pipeline_mac__L60"
wire saturate_mode__case04_pipeline_mac__L19; // pyc.name="saturate_mode__case04_pipeline_mac__L19"
wire valid_in__case04_pipeline_mac__L17; // pyc.name="valid_in__case04_pipeline_mac__L17"

// --- Combinational (netlist)
assign s1_a = pyc_reg_18;
assign s1_a__case04_pipeline_mac__L21 = s1_a;
assign pyc_comb_19 = s1_a__case04_pipeline_mac__L21;
assign s1_b = pyc_reg_20;
assign s1_b__case04_pipeline_mac__L22 = s1_b;
assign pyc_comb_21 = s1_b__case04_pipeline_mac__L22;
assign s1_v = pyc_reg_22;
assign s1_v__case04_pipeline_mac__L23 = s1_v;
assign s2_v__next = s1_v__case04_pipeline_mac__L23;
assign pyc_comb_23 = s2_v__next;
assign s1_clr = pyc_reg_24;
assign s1_clr__case04_pipeline_mac__L24 = s1_clr;
assign s2_clr__next = s1_clr__case04_pipeline_mac__L24;
assign pyc_comb_25 = s2_clr__next;
assign s1_sat = pyc_reg_26;
assign s1_sat__case04_pipeline_mac__L25 = s1_sat;
assign s2_sat__next = s1_sat__case04_pipeline_mac__L25;
assign pyc_comb_27 = s2_sat__next;
assign s2_prod = pyc_reg_28;
assign s2_prod__case04_pipeline_mac__L27 = s2_prod;
assign pyc_comb_29 = s2_prod__case04_pipeline_mac__L27;
assign s2_v = pyc_reg_30;
assign s2_v__case04_pipeline_mac__L28 = s2_v;
assign s3_v__next = s2_v__case04_pipeline_mac__L28;
assign pyc_comb_31 = s3_v__next;
assign s2_clr = pyc_reg_32;
assign s2_clr__case04_pipeline_mac__L29 = s2_clr;
assign pyc_comb_33 = s2_clr__case04_pipeline_mac__L29;
assign s2_sat = pyc_reg_34;
assign s2_sat__case04_pipeline_mac__L30 = s2_sat;
assign pyc_comb_35 = s2_sat__case04_pipeline_mac__L30;
assign s3_sum = pyc_reg_36;
assign s3_sum__case04_pipeline_mac__L32 = s3_sum;
assign pyc_comb_37 = s3_sum__case04_pipeline_mac__L32;
assign s3_v = pyc_reg_38;
assign s3_v__case04_pipeline_mac__L33 = s3_v;
assign pyc_comb_39 = s3_v__case04_pipeline_mac__L33;
assign acc_q = pyc_reg_40;
assign acc__case04_pipeline_mac__L36 = acc_q;
assign pyc_zext_41 = {{16{1'b0}}, pyc_comb_19};
assign a_ext__case04_pipeline_mac__L44 = pyc_zext_41;
assign pyc_zext_42 = {{16{1'b0}}, pyc_comb_21};
assign b_ext__case04_pipeline_mac__L45 = pyc_zext_42;
assign pyc_mul_43 = (a_ext__case04_pipeline_mac__L44 * b_ext__case04_pipeline_mac__L45);
assign product__case04_pipeline_mac__L46 = pyc_mul_43;
assign pyc_comb_44 = acc__case04_pipeline_mac__L36;
assign pyc_comb_45 = product__case04_pipeline_mac__L46;
assign pyc_extract_54 = pyc_comb_37[31:0];
assign result__case04_pipeline_mac__L68 = pyc_extract_54;
assign pyc_comb_55 = result__case04_pipeline_mac__L68;
assign pyc_constant_1 = 1'd1;
assign pyc_constant_2 = 16'd0;
assign pyc_constant_3 = 1'd0;
assign pyc_constant_4 = 32'd0;
assign pyc_constant_5 = 40'd0;
assign pyc_constant_6 = 40'd549755813887;
assign a_in__case04_pipeline_mac__L15 = a_in;
assign s1_a__next = a_in__case04_pipeline_mac__L15;
assign b_in__case04_pipeline_mac__L16 = b_in;
assign s1_b__next = b_in__case04_pipeline_mac__L16;
assign valid_in__case04_pipeline_mac__L17 = valid_in;
assign s1_v__next = valid_in__case04_pipeline_mac__L17;
assign acc_clear__case04_pipeline_mac__L18 = acc_clear;
assign s1_clr__next = acc_clear__case04_pipeline_mac__L18;
assign saturate_mode__case04_pipeline_mac__L19 = saturate_mode;
assign s1_sat__next = saturate_mode__case04_pipeline_mac__L19;
assign pyc_comb_7 = pyc_constant_1;
assign pyc_comb_8 = pyc_constant_2;
assign pyc_comb_9 = pyc_constant_3;
assign pyc_comb_10 = pyc_constant_4;
assign pyc_comb_11 = pyc_constant_5;
assign pyc_comb_12 = pyc_constant_6;
assign pyc_comb_13 = s1_a__next;
assign pyc_comb_14 = s1_b__next;
assign pyc_comb_15 = s1_v__next;
assign pyc_comb_16 = s1_clr__next;
assign pyc_comb_17 = s1_sat__next;
assign acc_val__case04_pipeline_mac__L53 = pyc_comb_44;
assign pyc_mux_46 = (pyc_comb_33 ? pyc_comb_11 : acc_val__case04_pipeline_mac__L53);
assign acc_base__case04_pipeline_mac__L54 = pyc_mux_46;
assign pyc_zext_47 = {{8{1'b0}}, pyc_comb_29};
assign prod_ext__case04_pipeline_mac__L55 = pyc_zext_47;
assign pyc_add_48 = (acc_base__case04_pipeline_mac__L54 + prod_ext__case04_pipeline_mac__L55);
assign raw_sum__case04_pipeline_mac__L56 = pyc_add_48;
assign pyc_extract_49 = raw_sum__case04_pipeline_mac__L56[39];
assign overflow__case04_pipeline_mac__L59 = pyc_extract_49;
assign pyc_and_50 = (overflow__case04_pipeline_mac__L59 & pyc_comb_35);
assign pyc_mux_51 = (pyc_and_50 ? pyc_comb_12 : raw_sum__case04_pipeline_mac__L56);
assign sat_sum__case04_pipeline_mac__L60 = pyc_mux_51;
assign pyc_comb_52 = sat_sum__case04_pipeline_mac__L60;
assign pyc_mux_53 = (pyc_comb_39 ? pyc_comb_37 : pyc_comb_44);
assign acc_q__next = pyc_mux_53;
assign s2_prod__next = pyc_comb_45;
assign s3_sum__next = pyc_comb_52;

// --- Sequential primitives
pyc_reg #(.WIDTH(16)) pyc_reg_18_inst (
  .clk(clk),
  .rst(rst),
  .en(pyc_comb_7),
  .d(pyc_comb_13),
  .init(pyc_comb_8),
  .q(pyc_reg_18)
);
pyc_reg #(.WIDTH(16)) pyc_reg_20_inst (
  .clk(clk),
  .rst(rst),
  .en(pyc_comb_7),
  .d(pyc_comb_14),
  .init(pyc_comb_8),
  .q(pyc_reg_20)
);
pyc_reg #(.WIDTH(1)) pyc_reg_22_inst (
  .clk(clk),
  .rst(rst),
  .en(pyc_comb_7),
  .d(pyc_comb_15),
  .init(pyc_comb_9),
  .q(pyc_reg_22)
);
pyc_reg #(.WIDTH(1)) pyc_reg_24_inst (
  .clk(clk),
  .rst(rst),
  .en(pyc_comb_7),
  .d(pyc_comb_16),
  .init(pyc_comb_9),
  .q(pyc_reg_24)
);
pyc_reg #(.WIDTH(1)) pyc_reg_26_inst (
  .clk(clk),
  .rst(rst),
  .en(pyc_comb_7),
  .d(pyc_comb_17),
  .init(pyc_comb_9),
  .q(pyc_reg_26)
);
pyc_reg #(.WIDTH(32)) pyc_reg_28_inst (
  .clk(clk),
  .rst(rst),
  .en(pyc_comb_7),
  .d(s2_prod__next),
  .init(pyc_comb_10),
  .q(pyc_reg_28)
);
pyc_reg #(.WIDTH(1)) pyc_reg_30_inst (
  .clk(clk),
  .rst(rst),
  .en(pyc_comb_7),
  .d(pyc_comb_23),
  .init(pyc_comb_9),
  .q(pyc_reg_30)
);
pyc_reg #(.WIDTH(1)) pyc_reg_32_inst (
  .clk(clk),
  .rst(rst),
  .en(pyc_comb_7),
  .d(pyc_comb_25),
  .init(pyc_comb_9),
  .q(pyc_reg_32)
);
pyc_reg #(.WIDTH(1)) pyc_reg_34_inst (
  .clk(clk),
  .rst(rst),
  .en(pyc_comb_7),
  .d(pyc_comb_27),
  .init(pyc_comb_9),
  .q(pyc_reg_34)
);
pyc_reg #(.WIDTH(40)) pyc_reg_36_inst (
  .clk(clk),
  .rst(rst),
  .en(pyc_comb_7),
  .d(s3_sum__next),
  .init(pyc_comb_11),
  .q(pyc_reg_36)
);
pyc_reg #(.WIDTH(1)) pyc_reg_38_inst (
  .clk(clk),
  .rst(rst),
  .en(pyc_comb_7),
  .d(pyc_comb_31),
  .init(pyc_comb_9),
  .q(pyc_reg_38)
);
pyc_reg #(.WIDTH(40)) pyc_reg_40_inst (
  .clk(clk),
  .rst(rst),
  .en(pyc_comb_7),
  .d(acc_q__next),
  .init(pyc_comb_11),
  .q(pyc_reg_40)
);

assign result = pyc_comb_55;
assign valid_out = pyc_comb_39;
assign accumulator = pyc_comb_44;

endmodule

