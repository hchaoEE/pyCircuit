# EDA 工具测试计划 — 10 个测试用例

## 概览

| # | Case 名称 | 测试重点 | 规模 | 时钟域 | 关键 EDA 验证点 |
|---|----------|---------|------|--------|----------------|
| 1 | `comb_alu` | 纯组合逻辑优化 | ~200 门 | 0 | 逻辑综合、面积优化、关键路径分析 |
| 2 | `shift_register` | 基础时序设计 | 32 reg | 1 | 时序分析、建立/保持时间、扫描链 |
| 3 | `fsm_traffic` | 有限状态机 | ~10 reg | 1 | 状态编码优化、FSM 提取、覆盖率 |
| 4 | `pipeline_mac` | 流水线乘加 | ~8 reg | 1 | DSP 推断、流水线重定时、吞吐量 |
| 5 | `sync_fifo` | 同步 FIFO | ~20 reg | 1 | 存储器推断、满/空逻辑、形式验证 |
| 6 | `multi_clock` | 多时钟域 | ~10 reg | 2 | CDC 分析、亚稳态检查、异步 FIFO |
| 7 | `bus_arbiter` | 总线仲裁 | ~30 reg | 1 | 高扇出优化、优先级编码、公平性 |
| 8 | `hier_soc` | 层次化 SoC | ~50 reg | 1 | 模块划分、层次综合、接口检查 |
| 9 | `mem_subsys` | 存储器子系统 | ~40 reg | 1 | SRAM 推断、地址译码、ECC 逻辑 |
| 10 | `rv32i_cpu` | 完整处理器 | 60 reg / 1345b | 1 | 端到端综合、STA、功耗分析 |

---

## Case 1: `comb_alu` — 纯组合逻辑 ALU

**目的**: 测试综合工具的组合逻辑优化能力（常量折叠、逻辑合并、关键路径优化）

**设计描述**:
- 32 位无流水线 ALU，支持 8 种运算（ADD/SUB/AND/OR/XOR/SLT/SLL/SRL）
- 纯组合输出，无寄存器
- 含 carry-lookahead 风格的进位链

**EDA 验证点**:
- 逻辑综合后面积 vs 原始门数
- 组合路径延迟分析
- 等价性检查（combinational equivalence）
- 功耗估计（仅动态功耗）

**预期规模**: ~200 等效门，0 寄存器，组合深度 6-8 级

---

## Case 2: `shift_register` — 移位寄存器链

**目的**: 测试基本时序约束验证和扫描链插入能力

**设计描述**:
- 32 位可配置移位寄存器（SISO/SIPO/PISO/PIPO 模式）
- 支持左移、右移、循环移位
- 可编程移位步长（1/2/4/8）

**EDA 验证点**:
- 建立时间 (setup) / 保持时间 (hold) 分析
- 时钟树综合 (CTS) 与偏斜分析
- 扫描链插入与 DFT
- 门控时钟检查

**预期规模**: 32 个寄存器，~100 等效门组合逻辑

---

## Case 3: `fsm_traffic` — 交通灯有限状态机

**目的**: 测试 FSM 提取、状态编码优化和功能覆盖率分析

**设计描述**:
- 十字路口交通灯控制器
- 6 个状态：NS_GREEN / NS_YELLOW / NS_RED / EW_GREEN / EW_YELLOW / EW_RED
- 可编程定时器（每个状态持续不同周期数）
- 紧急车辆优先信号

**EDA 验证点**:
- FSM 状态编码（one-hot vs binary vs gray）
- 不可达状态检测
- 状态覆盖率 / 迁移覆盖率
- 功能仿真与波形验证

**预期规模**: ~10 寄存器，~150 等效门

---

## Case 4: `pipeline_mac` — 4 级流水线乘加单元

**目的**: 测试 DSP 推断、流水线重定时和吞吐量分析

**设计描述**:
- 16×16 → 32 位乘法 + 32 位累加
- 4 级流水线：输入锁存 → 乘法低位 → 乘法高位+加法 → 输出锁存
- 饱和与截断模式可配置
- 支持复位累加器

**EDA 验证点**:
- DSP48/乘法器原语推断
- 流水线重定时 (retiming) 优化
- 吞吐量（1 结果/周期）验证
- 时序路径中的乘法器延迟

**预期规模**: ~8 寄存器（~128 位），乘法器逻辑

---

## Case 5: `sync_fifo` — 同步 FIFO 队列

**目的**: 测试存储器推断和 FIFO 相关逻辑验证

**设计描述**:
- 深度 16、宽度 32 位同步 FIFO
- 读/写指针管理（格雷码计数器可选）
- 满/空/半满状态标志
- 上溢/下溢保护

**EDA 验证点**:
- Block RAM / 分布式 RAM 推断
- 满/空逻辑正确性（形式验证）
- FIFO 深度与吞吐量分析
- 仿真中 push/pop 序列验证

**预期规模**: ~20 寄存器 + 16×32 存储阵列

---

## Case 6: `multi_clock` — 双时钟域设计

**目的**: 测试 CDC（Clock Domain Crossing）分析和异步设计检查

**设计描述**:
- 两个独立时钟域（clk_fast 200 MHz, clk_slow 50 MHz）
- 快时钟域：高速数据采集计数器
- 慢时钟域：状态累加器
- 跨域信号传递（2 级同步器 + 握手协议）

**EDA 验证点**:
- CDC 路径识别与分析
- 亚稳态风险评估
- 多时钟 SDC 约束正确性
- set_false_path / set_max_delay 跨域约束

**预期规模**: ~10 寄存器，2 个时钟域

---

## Case 7: `bus_arbiter` — 4 端口总线仲裁器

**目的**: 测试高扇出优化、优先级编码和公平调度逻辑

**设计描述**:
- 4 个主设备端口请求共享总线
- 支持固定优先级和轮询 (round-robin) 两种模式
- 请求/授权/数据传输握手
- 锁定 (lock) 与突发 (burst) 支持

**EDA 验证点**:
- 高扇出信号优化（grant 信号）
- 仲裁公平性验证（形式或仿真）
- 优先级编码器综合效率
- 死锁自由 (deadlock-free) 验证

**预期规模**: ~30 寄存器，~400 等效门

---

## Case 8: `hier_soc` — 层次化小型 SoC

**目的**: 测试层次化综合、模块划分和接口一致性

**设计描述**:
- 顶层集成 3 个子模块：
  - `core`: 简化处理核心（ALU + 寄存器 + PC）
  - `timer`: 可编程定时器（倒计数 + 中断）
  - `gpio`: 通用 IO 控制器（8 位，方向可配）
- 共享总线互连（地址译码 + 数据路由）

**EDA 验证点**:
- 层次综合 vs 展平综合对比
- 模块间接口时序约束
- 层次化时序预算 (time budgeting)
- 设计规则检查 (DRC)

**预期规模**: ~50 寄存器，3 个子模块层次

---

## Case 9: `mem_subsys` — 存储器子系统

**目的**: 测试 SRAM 推断、地址译码和 ECC 逻辑综合

**设计描述**:
- 4 组存储体 (bank)，每组 64×8 位
- 地址译码器（bank 选择 + 字内偏移）
- 单比特纠错 / 双比特检错 (SEC-DED) 汉明码
- 读-修改-写 (read-modify-write) 支持

**EDA 验证点**:
- SRAM / Block RAM 推断
- ECC 编码/解码逻辑正确性
- 存储器读写时序路径
- 面积优化（ECC 开销 vs 数据宽度）

**预期规模**: ~40 寄存器 + 4×64×8 存储阵列

---

## Case 10: `rv32i_cpu` — 完整 RV32I 处理器（已实现）

**目的**: 端到端综合、STA 和功耗分析的集成测试

**设计描述**: （已在上一步实现）
- 32 位 5 级流水线 RV32I CPU
- 32 个通用寄存器、完整 ALU、桶形移位器
- 数据前递、分支刷新
- 外部指令/数据存储器接口

**EDA 验证点**:
- 完整综合流程（RTL → 网表 → STA → 功耗）
- 关键路径分析（ALU / 前递 / 分支判断）
- 时钟频率可达性（100 MHz 目标）
- 功耗估计（动态 + 漏电）

**预期规模**: 60 寄存器 (1345 bits), 2712 行 Verilog

---

## 测试执行矩阵

| EDA 工具功能 | C1 | C2 | C3 | C4 | C5 | C6 | C7 | C8 | C9 | C10 |
|-------------|----|----|----|----|----|----|----|----|----|----|
| RTL 综合 | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ |
| STA 时序分析 | - | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ |
| CDC 分析 | - | - | - | - | - | ✓ | - | - | - | - |
| 形式验证 | ✓ | - | ✓ | - | ✓ | - | ✓ | - | ✓ | - |
| 功能仿真 | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ |
| 功耗分析 | - | ✓ | - | ✓ | - | ✓ | - | ✓ | - | ✓ |
| DFT/扫描 | - | ✓ | - | - | - | - | - | - | - | ✓ |
| 层次综合 | - | - | - | - | - | - | - | ✓ | - | - |
| 存储器推断 | - | - | - | - | ✓ | - | - | - | ✓ | - |
| DSP 推断 | - | - | - | ✓ | - | - | - | - | - | - |
